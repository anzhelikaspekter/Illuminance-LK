<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Dashboard overview with deposits, statistics, and transactions." />
    <meta name="theme-color" content="#0b0f19" />
    <title>Referral</title>
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="css/style.min.css">
</head>

<body style="background-color: var(--bg-color);">
    <section class="referral">
        <div class="referral__wrap">
            <article class="referral__card">
                <h1 class="referral__card-title">Total team turnover</h1>
                <div class="referral__card-desc-wrap">
                    <p class="referral__card-desc-sum">~ 422,738.98 <span class="network">USDT</span></p>
                    <p class="referral__card-desc-count">≈ 6.14511533 BTC</p>
                </div>
            </article>
            <article class="referral__card">
                <header class="referral__card-header">
                    <h2 class="referral__card-header-title">Your Current Level</h2>
                    <p class="referral__card-header-desc">Last 30 days</p>
                </header>
                <ul class="referral__list">
                    <li class="referral__item">
                        <h3 class="referral__item-title"><img src="img/icon/turnover.svg" width="20" height="20" alt=""
                                class="referral__item-title-icon"> Turnover</h3>
                        <p class="referral__item-desc">5,200 $</p>
                    </li>
                    <li class="referral__item">
                        <h3 class="referral__item-title"><img src="img/icon/referral-earnings.svg" width="20"
                                height="20" alt="" class="referral__item-title-icon"> Referral Earnings</h3>
                        <p class="referral__item-desc">250 $</p>
                    </li>
                    <li class="referral__item">
                        <h3 class="referral__item-title"><img src="img/icon/referral-partners.svg" width="20"
                                height="20" alt="" class="referral__item-title-icon"> Partners</h3>
                        <p class="referral__item-desc">3,100 $</p>
                    </li>
                </ul>
            </article>
        </div>
        <div class="referral__wrap" id="currentLevel">
            <article class="referral__card" id="gridSystem">
                <header class="referral__card-header">
                    <h2 class="referral__card-header-title">History of Referrals</h2>
                    <p class="referral__card-header-desc">Track your latest crypto activity with clear transaction
                        history — amounts, dates, fiat value, and status at a glance.</p>
                </header>
                <div class="referral__grid-wrap dragging">
                    <div class="referral__grid-canvas">
                        <canvas class="referral__grid-lines"></canvas>
                        <div class="referral__grid">
                            <div class="referral__grid-item"></div>
                            <div class="referral__grid-item" data-id="1" data-parent="">
                                <article class="referral__grid-card active" data-user="1">
                                    <h3 class="referral__grid-status"><span class="dot"></span> Inactive</h3>
                                    <button type="button" class="referral__grid-card-user" data-toggle="tooltip"
                                        data-user="1">
                                        <img src="img/user.webp" width="40" height="40" alt=""
                                            class="referral__grid-card-user-img">
                                        <div class="referral__grid-card-user-title-wrap">
                                            <h4 class="referral__grid-card-user-title">Jakub Hansen</h4>
                                            <a href="mailto:debra.holt@gmail.com"
                                                class="referral__grid-card-user-desc">debra.holt@gmail.com</a>
                                        </div>
                                        <p class="referral__grid-card-user-sum">5,2k $</p>
                                    </button>
                                    <div class="referral__grid-user-tooltip" data-user="1" hidden>
                                        <dl>
                                            <dd>Rank</dd>
                                            <dt><img src="img/icon/gold.svg" width="20" height="20" alt=""
                                                    class="referral__grid-user-tooltip-icon"> Gold</dt>

                                            <dd>Line (Level)</dd>
                                            <dt>L2</dt>

                                            <dd>Upline</dd>
                                            <dt>A. Black (L1)</dt>

                                            <dd>Turnover</dd>
                                            <dt>$18,750 <span class="desc">(last 30 days)</span></dt>

                                            <dd>Registration Date</dd>
                                            <dt><time datetime="2008-01-14">14 Jan 2008</time></dt>

                                            <dd>Deposit Amount</dd>
                                            <dt>$4,200</dt>

                                            <dd>First Deposit</dd>
                                            <dt><time datetime="2008-02-20">20 Feb 2008</time></dt>

                                            <dd>Last Deposit</dd>
                                            <dt><time datetime="2025-03-12">12 Mar 2025</time></dt>

                                            <dd>Last Deposit</dd>
                                            <dt><a href="mailto:debra.holt@gmail.com">debra.holt@gmail.com</a></dt>
                                        </dl>
                                        <div class="referral__grid-user-tooltip-wrapper">
                                            <div class="referral__grid-user-tooltip-wrap">
                                                <div class="referral__grid-user-tooltip-title-wrap">
                                                    <h3 class="referral__grid-user-tooltip-title"><img
                                                            src="img/icon/user-tooltip-referrals.svg" width="20"
                                                            height="20" alt="" class="referral__grid-user-tooltip-icon">
                                                        Referrals</h3>
                                                    <p class="referral__grid-user-tooltip-desc">6 <span
                                                            class="info">(Active: 4)</span>
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="referral__grid-user-tooltip-wrap">
                                                <div class="referral__grid-user-tooltip-title-wrap">
                                                    <h3 class="referral__grid-user-tooltip-title"> <img
                                                            src="img/icon/user-tooltip-payouts.svg" width="20"
                                                            height="20" alt="" class="referral__grid-user-tooltip-icon">
                                                        Payouts</h3>
                                                    <p class="referral__grid-user-tooltip-desc">361 $</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </article>
                            </div>
                            <div class="referral__grid-item"></div>
                            <div class="referral__grid-item"></div>

                            <div class="referral__grid-item" data-id="2" data-parent="1">
                                <article class="referral__grid-card" data-user="2">
                                    <h3 class="referral__grid-status"><span class="dot"></span> Inactive</h3>
                                    <button type="button" class="referral__grid-card-user" data-toggle="tooltip"
                                        data-user="2">
                                        <img src="img/user.webp" width="40" height="40" alt=""
                                            class="referral__grid-card-user-img">
                                        <div class="referral__grid-card-user-title-wrap">
                                            <h4 class="referral__grid-card-user-title">Jakub Hansen</h4>
                                            <a href="mailto:debra.holt@gmail.com"
                                                class="referral__grid-card-user-desc">debra.holt@gmail.com</a>
                                        </div>
                                        <p class="referral__grid-card-user-sum">5,2k $</p>
                                    </button>
                                    <div class="referral__grid-user-tooltip" data-user="2" hidden>
                                        <dl>
                                            <dd>Rank</dd>
                                            <dt><img src="img/icon/gold.svg" width="20" height="20" alt=""
                                                    class="referral__grid-user-tooltip-icon"> Gold</dt>

                                            <dd>Line (Level)</dd>
                                            <dt>L2</dt>

                                            <dd>Upline</dd>
                                            <dt>A. Black (L1)</dt>

                                            <dd>Turnover</dd>
                                            <dt>$18,750 <span class="desc">(last 30 days)</span></dt>

                                            <dd>Registration Date</dd>
                                            <dt><time datetime="2008-01-14">14 Jan 2008</time></dt>

                                            <dd>Deposit Amount</dd>
                                            <dt>$4,200</dt>

                                            <dd>First Deposit</dd>
                                            <dt><time datetime="2008-02-20">20 Feb 2008</time></dt>

                                            <dd>Last Deposit</dd>
                                            <dt><time datetime="2025-03-12">12 Mar 2025</time></dt>

                                            <dd>Last Deposit</dd>
                                            <dt><a href="mailto:debra.holt@gmail.com">debra.holt@gmail.com</a></dt>
                                        </dl>
                                        <div class="referral__grid-user-tooltip-wrapper">
                                            <div class="referral__grid-user-tooltip-wrap">
                                                <div class="referral__grid-user-tooltip-title-wrap">
                                                    <h3 class="referral__grid-user-tooltip-title"><img
                                                            src="img/icon/user-tooltip-referrals.svg" width="20"
                                                            height="20" alt="" class="referral__grid-user-tooltip-icon">
                                                        Referrals</h3>
                                                    <p class="referral__grid-user-tooltip-desc">6 <span
                                                            class="info">(Active: 4)</span>
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="referral__grid-user-tooltip-wrap">
                                                <div class="referral__grid-user-tooltip-title-wrap">
                                                    <h3 class="referral__grid-user-tooltip-title"> <img
                                                            src="img/icon/user-tooltip-payouts.svg" width="20"
                                                            height="20" alt="" class="referral__grid-user-tooltip-icon">
                                                        Payouts</h3>
                                                    <p class="referral__grid-user-tooltip-desc">361 $</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </article>
                            </div>
                            <div class="referral__grid-item" data-id="3" data-parent="1">
                                <article class="referral__grid-card" data-user="3">
                                    <h3 class="referral__grid-status"><span class="dot"></span> Inactive</h3>
                                    <button type="button" class="referral__grid-card-user" data-toggle="tooltip"
                                        data-user="3">
                                        <img src="img/user.webp" width="40" height="40" alt=""
                                            class="referral__grid-card-user-img">
                                        <div class="referral__grid-card-user-title-wrap">
                                            <h4 class="referral__grid-card-user-title">Jakub Hansen</h4>
                                            <a href="mailto:debra.holt@gmail.com"
                                                class="referral__grid-card-user-desc">debra.holt@gmail.com</a>
                                        </div>
                                        <p class="referral__grid-card-user-sum">5,2k $</p>
                                    </button>
                                    <div class="referral__grid-user-tooltip" data-user="3" hidden>
                                        <dl>
                                            <dd>Rank</dd>
                                            <dt><img src="img/icon/gold.svg" width="20" height="20" alt=""
                                                    class="referral__grid-user-tooltip-icon"> Gold</dt>

                                            <dd>Line (Level)</dd>
                                            <dt>L2</dt>

                                            <dd>Upline</dd>
                                            <dt>A. Black (L1)</dt>

                                            <dd>Turnover</dd>
                                            <dt>$18,750 <span class="desc">(last 30 days)</span></dt>

                                            <dd>Registration Date</dd>
                                            <dt><time datetime="2008-01-14">14 Jan 2008</time></dt>

                                            <dd>Deposit Amount</dd>
                                            <dt>$4,200</dt>

                                            <dd>First Deposit</dd>
                                            <dt><time datetime="2008-02-20">20 Feb 2008</time></dt>

                                            <dd>Last Deposit</dd>
                                            <dt><time datetime="2025-03-12">12 Mar 2025</time></dt>

                                            <dd>Last Deposit</dd>
                                            <dt><a href="mailto:debra.holt@gmail.com">debra.holt@gmail.com</a></dt>
                                        </dl>
                                        <div class="referral__grid-user-tooltip-wrapper">
                                            <div class="referral__grid-user-tooltip-wrap">
                                                <div class="referral__grid-user-tooltip-title-wrap">
                                                    <h3 class="referral__grid-user-tooltip-title"><img
                                                            src="img/icon/user-tooltip-referrals.svg" width="20"
                                                            height="20" alt="" class="referral__grid-user-tooltip-icon">
                                                        Referrals</h3>
                                                    <p class="referral__grid-user-tooltip-desc">6 <span
                                                            class="info">(Active: 4)</span>
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="referral__grid-user-tooltip-wrap">
                                                <div class="referral__grid-user-tooltip-title-wrap">
                                                    <h3 class="referral__grid-user-tooltip-title"> <img
                                                            src="img/icon/user-tooltip-payouts.svg" width="20"
                                                            height="20" alt="" class="referral__grid-user-tooltip-icon">
                                                        Payouts</h3>
                                                    <p class="referral__grid-user-tooltip-desc">361 $</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </article>
                            </div>
                            <div class="referral__grid-item" data-id="4" data-parent="1">
                                <article class="referral__grid-card" data-user="4">
                                    <h3 class="referral__grid-status"><span class="dot"></span> Inactive</h3>
                                    <button type="button" class="referral__grid-card-user" data-toggle="tooltip"
                                        data-user="4">
                                        <img src="img/user.webp" width="40" height="40" alt=""
                                            class="referral__grid-card-user-img">
                                        <div class="referral__grid-card-user-title-wrap">
                                            <h4 class="referral__grid-card-user-title">Jakub Hansen</h4>
                                            <a href="mailto:debra.holt@gmail.com"
                                                class="referral__grid-card-user-desc">debra.holt@gmail.com</a>
                                        </div>
                                        <p class="referral__grid-card-user-sum">5,2k $</p>
                                    </button>
                                    <div class="referral__grid-user-tooltip" data-user="4" hidden>
                                        <dl>
                                            <dd>Rank</dd>
                                            <dt><img src="img/icon/gold.svg" width="20" height="20" alt=""
                                                    class="referral__grid-user-tooltip-icon"> Gold</dt>

                                            <dd>Line (Level)</dd>
                                            <dt>L2</dt>

                                            <dd>Upline</dd>
                                            <dt>A. Black (L1)</dt>

                                            <dd>Turnover</dd>
                                            <dt>$18,750 <span class="desc">(last 30 days)</span></dt>

                                            <dd>Registration Date</dd>
                                            <dt><time datetime="2008-01-14">14 Jan 2008</time></dt>

                                            <dd>Deposit Amount</dd>
                                            <dt>$4,200</dt>

                                            <dd>First Deposit</dd>
                                            <dt><time datetime="2008-02-20">20 Feb 2008</time></dt>

                                            <dd>Last Deposit</dd>
                                            <dt><time datetime="2025-03-12">12 Mar 2025</time></dt>

                                            <dd>Last Deposit</dd>
                                            <dt><a href="mailto:debra.holt@gmail.com">debra.holt@gmail.com</a></dt>
                                        </dl>
                                        <div class="referral__grid-user-tooltip-wrapper">
                                            <div class="referral__grid-user-tooltip-wrap">
                                                <div class="referral__grid-user-tooltip-title-wrap">
                                                    <h3 class="referral__grid-user-tooltip-title"><img
                                                            src="img/icon/user-tooltip-referrals.svg" width="20"
                                                            height="20" alt="" class="referral__grid-user-tooltip-icon">
                                                        Referrals</h3>
                                                    <p class="referral__grid-user-tooltip-desc">6 <span
                                                            class="info">(Active: 4)</span>
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="referral__grid-user-tooltip-wrap">
                                                <div class="referral__grid-user-tooltip-title-wrap">
                                                    <h3 class="referral__grid-user-tooltip-title"> <img
                                                            src="img/icon/user-tooltip-payouts.svg" width="20"
                                                            height="20" alt="" class="referral__grid-user-tooltip-icon">
                                                        Payouts</h3>
                                                    <p class="referral__grid-user-tooltip-desc">361 $</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </article>
                            </div>
                            <div class="referral__grid-item" data-id="5" data-parent="1">
                                <article class="referral__grid-card" data-user="5">
                                    <h3 class="referral__grid-status"><span class="dot"></span> Inactive</h3>
                                    <button type="button" class="referral__grid-card-user" data-toggle="tooltip"
                                        data-user="5">
                                        <img src="img/user.webp" width="40" height="40" alt=""
                                            class="referral__grid-card-user-img">
                                        <div class="referral__grid-card-user-title-wrap">
                                            <h4 class="referral__grid-card-user-title">Jakub Hansen</h4>
                                            <a href="mailto:debra.holt@gmail.com"
                                                class="referral__grid-card-user-desc">debra.holt@gmail.com</a>
                                        </div>
                                        <p class="referral__grid-card-user-sum">5,2k $</p>
                                    </button>
                                    <div class="referral__grid-user-tooltip" data-user="5" hidden>
                                        <dl>
                                            <dd>Rank</dd>
                                            <dt><img src="img/icon/gold.svg" width="20" height="20" alt=""
                                                    class="referral__grid-user-tooltip-icon"> Gold</dt>

                                            <dd>Line (Level)</dd>
                                            <dt>L2</dt>

                                            <dd>Upline</dd>
                                            <dt>A. Black (L1)</dt>

                                            <dd>Turnover</dd>
                                            <dt>$18,750 <span class="desc">(last 30 days)</span></dt>

                                            <dd>Registration Date</dd>
                                            <dt><time datetime="2008-01-14">14 Jan 2008</time></dt>

                                            <dd>Deposit Amount</dd>
                                            <dt>$4,200</dt>

                                            <dd>First Deposit</dd>
                                            <dt><time datetime="2008-02-20">20 Feb 2008</time></dt>

                                            <dd>Last Deposit</dd>
                                            <dt><time datetime="2025-03-12">12 Mar 2025</time></dt>

                                            <dd>Last Deposit</dd>
                                            <dt><a href="mailto:debra.holt@gmail.com">debra.holt@gmail.com</a></dt>
                                        </dl>
                                        <div class="referral__grid-user-tooltip-wrapper">
                                            <div class="referral__grid-user-tooltip-wrap">
                                                <div class="referral__grid-user-tooltip-title-wrap">
                                                    <h3 class="referral__grid-user-tooltip-title"><img
                                                            src="img/icon/user-tooltip-referrals.svg" width="20"
                                                            height="20" alt="" class="referral__grid-user-tooltip-icon">
                                                        Referrals</h3>
                                                    <p class="referral__grid-user-tooltip-desc">6 <span
                                                            class="info">(Active: 4)</span>
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="referral__grid-user-tooltip-wrap">
                                                <div class="referral__grid-user-tooltip-title-wrap">
                                                    <h3 class="referral__grid-user-tooltip-title"> <img
                                                            src="img/icon/user-tooltip-payouts.svg" width="20"
                                                            height="20" alt="" class="referral__grid-user-tooltip-icon">
                                                        Payouts</h3>
                                                    <p class="referral__grid-user-tooltip-desc">361 $</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </article>
                            </div>
                            <div class="referral__grid-item" data-id="6" data-parent="1">
                                <article class="referral__grid-card" data-user="6">
                                    <h3 class="referral__grid-status"><span class="dot"></span> Inactive</h3>
                                    <button type="button" class="referral__grid-card-user" data-toggle="tooltip"
                                        data-user="6">
                                        <img src="img/user.webp" width="40" height="40" alt=""
                                            class="referral__grid-card-user-img">
                                        <div class="referral__grid-card-user-title-wrap">
                                            <h4 class="referral__grid-card-user-title">Jakub Hansen</h4>
                                            <a href="mailto:debra.holt@gmail.com"
                                                class="referral__grid-card-user-desc">debra.holt@gmail.com</a>
                                        </div>
                                        <p class="referral__grid-card-user-sum">5,2k $</p>
                                    </button>
                                    <div class="referral__grid-user-tooltip" data-user="6" hidden>
                                        <dl>
                                            <dd>Rank</dd>
                                            <dt><img src="img/icon/gold.svg" width="20" height="20" alt=""
                                                    class="referral__grid-user-tooltip-icon"> Gold</dt>

                                            <dd>Line (Level)</dd>
                                            <dt>L2</dt>

                                            <dd>Upline</dd>
                                            <dt>A. Black (L1)</dt>

                                            <dd>Turnover</dd>
                                            <dt>$18,750 <span class="desc">(last 30 days)</span></dt>

                                            <dd>Registration Date</dd>
                                            <dt><time datetime="2008-01-14">14 Jan 2008</time></dt>

                                            <dd>Deposit Amount</dd>
                                            <dt>$4,200</dt>

                                            <dd>First Deposit</dd>
                                            <dt><time datetime="2008-02-20">20 Feb 2008</time></dt>

                                            <dd>Last Deposit</dd>
                                            <dt><time datetime="2025-03-12">12 Mar 2025</time></dt>

                                            <dd>Last Deposit</dd>
                                            <dt><a href="mailto:debra.holt@gmail.com">debra.holt@gmail.com</a></dt>
                                        </dl>
                                        <div class="referral__grid-user-tooltip-wrapper">
                                            <div class="referral__grid-user-tooltip-wrap">
                                                <div class="referral__grid-user-tooltip-title-wrap">
                                                    <h3 class="referral__grid-user-tooltip-title"><img
                                                            src="img/icon/user-tooltip-referrals.svg" width="20"
                                                            height="20" alt="" class="referral__grid-user-tooltip-icon">
                                                        Referrals</h3>
                                                    <p class="referral__grid-user-tooltip-desc">6 <span
                                                            class="info">(Active: 4)</span>
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="referral__grid-user-tooltip-wrap">
                                                <div class="referral__grid-user-tooltip-title-wrap">
                                                    <h3 class="referral__grid-user-tooltip-title"> <img
                                                            src="img/icon/user-tooltip-payouts.svg" width="20"
                                                            height="20" alt="" class="referral__grid-user-tooltip-icon">
                                                        Payouts</h3>
                                                    <p class="referral__grid-user-tooltip-desc">361 $</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </article>
                            </div>

                            <div class="referral__grid-item"></div>
                            <div class="referral__grid-item" data-id="7" data-parent="3">
                                <article class="referral__grid-card" data-user="7">
                                    <h3 class="referral__grid-status"><span class="dot"></span> Inactive</h3>
                                    <button type="button" class="referral__grid-card-user" data-toggle="tooltip"
                                        data-user="7">
                                        <img src="img/user.webp" width="40" height="40" alt=""
                                            class="referral__grid-card-user-img">
                                        <div class="referral__grid-card-user-title-wrap">
                                            <h4 class="referral__grid-card-user-title">Jakub Hansen</h4>
                                            <a href="mailto:debra.holt@gmail.com"
                                                class="referral__grid-card-user-desc">debra.holt@gmail.com</a>
                                        </div>
                                        <p class="referral__grid-card-user-sum">5,2k $</p>
                                    </button>
                                    <div class="referral__grid-user-tooltip" data-user="7" hidden>
                                        <dl>
                                            <dd>Rank</dd>
                                            <dt><img src="img/icon/gold.svg" width="20" height="20" alt=""
                                                    class="referral__grid-user-tooltip-icon"> Gold</dt>

                                            <dd>Line (Level)</dd>
                                            <dt>L2</dt>

                                            <dd>Upline</dd>
                                            <dt>A. Black (L1)</dt>

                                            <dd>Turnover</dd>
                                            <dt>$18,750 <span class="desc">(last 30 days)</span></dt>

                                            <dd>Registration Date</dd>
                                            <dt><time datetime="2008-01-14">14 Jan 2008</time></dt>

                                            <dd>Deposit Amount</dd>
                                            <dt>$4,200</dt>

                                            <dd>First Deposit</dd>
                                            <dt><time datetime="2008-02-20">20 Feb 2008</time></dt>

                                            <dd>Last Deposit</dd>
                                            <dt><time datetime="2025-03-12">12 Mar 2025</time></dt>

                                            <dd>Last Deposit</dd>
                                            <dt><a href="mailto:debra.holt@gmail.com">debra.holt@gmail.com</a></dt>
                                        </dl>
                                        <div class="referral__grid-user-tooltip-wrapper">
                                            <div class="referral__grid-user-tooltip-wrap">
                                                <div class="referral__grid-user-tooltip-title-wrap">
                                                    <h3 class="referral__grid-user-tooltip-title"><img
                                                            src="img/icon/user-tooltip-referrals.svg" width="20"
                                                            height="20" alt="" class="referral__grid-user-tooltip-icon">
                                                        Referrals</h3>
                                                    <p class="referral__grid-user-tooltip-desc">6 <span
                                                            class="info">(Active: 4)</span>
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="referral__grid-user-tooltip-wrap">
                                                <div class="referral__grid-user-tooltip-title-wrap">
                                                    <h3 class="referral__grid-user-tooltip-title"> <img
                                                            src="img/icon/user-tooltip-payouts.svg" width="20"
                                                            height="20" alt="" class="referral__grid-user-tooltip-icon">
                                                        Payouts</h3>
                                                    <p class="referral__grid-user-tooltip-desc">361 $</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </article>
                            </div>
                            <div class="referral__grid-item"></div>
                            <div class="referral__grid-item"></div>
                            <div class="referral__grid-item" data-id="8" data-parent="5">
                                <article class="referral__grid-card" data-user="8">
                                    <h3 class="referral__grid-status"><span class="dot"></span> Inactive</h3>
                                    <button type="button" class="referral__grid-card-user" data-toggle="tooltip"
                                        data-user="8">
                                        <img src="img/user.webp" width="40" height="40" alt=""
                                            class="referral__grid-card-user-img">
                                        <div class="referral__grid-card-user-title-wrap">
                                            <h4 class="referral__grid-card-user-title">Jakub Hansen</h4>
                                            <a href="mailto:debra.holt@gmail.com"
                                                class="referral__grid-card-user-desc">debra.holt@gmail.com</a>
                                        </div>
                                        <p class="referral__grid-card-user-sum">5,2k $</p>
                                    </button>
                                    <div class="referral__grid-user-tooltip" data-user="8" hidden>
                                        <dl>
                                            <dd>Rank</dd>
                                            <dt><img src="img/icon/gold.svg" width="20" height="20" alt=""
                                                    class="referral__grid-user-tooltip-icon"> Gold</dt>

                                            <dd>Line (Level)</dd>
                                            <dt>L2</dt>

                                            <dd>Upline</dd>
                                            <dt>A. Black (L1)</dt>

                                            <dd>Turnover</dd>
                                            <dt>$18,750 <span class="desc">(last 30 days)</span></dt>

                                            <dd>Registration Date</dd>
                                            <dt><time datetime="2008-01-14">14 Jan 2008</time></dt>

                                            <dd>Deposit Amount</dd>
                                            <dt>$4,200</dt>

                                            <dd>First Deposit</dd>
                                            <dt><time datetime="2008-02-20">20 Feb 2008</time></dt>

                                            <dd>Last Deposit</dd>
                                            <dt><time datetime="2025-03-12">12 Mar 2025</time></dt>

                                            <dd>Last Deposit</dd>
                                            <dt><a href="mailto:debra.holt@gmail.com">debra.holt@gmail.com</a></dt>
                                        </dl>
                                        <div class="referral__grid-user-tooltip-wrapper">
                                            <div class="referral__grid-user-tooltip-wrap">
                                                <div class="referral__grid-user-tooltip-title-wrap">
                                                    <h3 class="referral__grid-user-tooltip-title"><img
                                                            src="img/icon/user-tooltip-referrals.svg" width="20"
                                                            height="20" alt="" class="referral__grid-user-tooltip-icon">
                                                        Referrals</h3>
                                                    <p class="referral__grid-user-tooltip-desc">6 <span
                                                            class="info">(Active: 4)</span>
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="referral__grid-user-tooltip-wrap">
                                                <div class="referral__grid-user-tooltip-title-wrap">
                                                    <h3 class="referral__grid-user-tooltip-title"> <img
                                                            src="img/icon/user-tooltip-payouts.svg" width="20"
                                                            height="20" alt="" class="referral__grid-user-tooltip-icon">
                                                        Payouts</h3>
                                                    <p class="referral__grid-user-tooltip-desc">361 $</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </article>
                            </div>

                            <div class="referral__grid-item"></div>
                            <div class="referral__grid-item" data-id="9" data-parent="7">
                                <article class="referral__grid-card" data-user="9">
                                    <h3 class="referral__grid-status"><span class="dot"></span> Inactive</h3>
                                    <button type="button" class="referral__grid-card-user" data-toggle="tooltip"
                                        data-user="9">
                                        <img src="img/user.webp" width="40" height="40" alt=""
                                            class="referral__grid-card-user-img">
                                        <div class="referral__grid-card-user-title-wrap">
                                            <h4 class="referral__grid-card-user-title">Jakub Hansen</h4>
                                            <a href="mailto:debra.holt@gmail.com"
                                                class="referral__grid-card-user-desc">debra.holt@gmail.com</a>
                                        </div>
                                        <p class="referral__grid-card-user-sum">5,2k $</p>
                                    </button>
                                    <div class="referral__grid-user-tooltip" data-user="9" hidden>
                                        <dl>
                                            <dd>Rank</dd>
                                            <dt><img src="img/icon/gold.svg" width="20" height="20" alt=""
                                                    class="referral__grid-user-tooltip-icon"> Gold</dt>

                                            <dd>Line (Level)</dd>
                                            <dt>L2</dt>

                                            <dd>Upline</dd>
                                            <dt>A. Black (L1)</dt>

                                            <dd>Turnover</dd>
                                            <dt>$18,750 <span class="desc">(last 30 days)</span></dt>

                                            <dd>Registration Date</dd>
                                            <dt><time datetime="2008-01-14">14 Jan 2008</time></dt>

                                            <dd>Deposit Amount</dd>
                                            <dt>$4,200</dt>

                                            <dd>First Deposit</dd>
                                            <dt><time datetime="2008-02-20">20 Feb 2008</time></dt>

                                            <dd>Last Deposit</dd>
                                            <dt><time datetime="2025-03-12">12 Mar 2025</time></dt>

                                            <dd>Last Deposit</dd>
                                            <dt><a href="mailto:debra.holt@gmail.com">debra.holt@gmail.com</a></dt>
                                        </dl>
                                        <div class="referral__grid-user-tooltip-wrapper">
                                            <div class="referral__grid-user-tooltip-wrap">
                                                <div class="referral__grid-user-tooltip-title-wrap">
                                                    <h3 class="referral__grid-user-tooltip-title"><img
                                                            src="img/icon/user-tooltip-referrals.svg" width="20"
                                                            height="20" alt="" class="referral__grid-user-tooltip-icon">
                                                        Referrals</h3>
                                                    <p class="referral__grid-user-tooltip-desc">6 <span
                                                            class="info">(Active: 4)</span>
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="referral__grid-user-tooltip-wrap">
                                                <div class="referral__grid-user-tooltip-title-wrap">
                                                    <h3 class="referral__grid-user-tooltip-title"> <img
                                                            src="img/icon/user-tooltip-payouts.svg" width="20"
                                                            height="20" alt="" class="referral__grid-user-tooltip-icon">
                                                        Payouts</h3>
                                                    <p class="referral__grid-user-tooltip-desc">361 $</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </article>
                            </div>
                            <div class="referral__grid-item"></div>
                            <div class="referral__grid-item"></div>
                        </div>
                    </div>
                </div>
            </article>
            <div class="referral__wrap column">
                <article class="referral__card" id="yourCurrentLevel">
                    <div class="referral__card-wrap-fill">
                        <h2 class="referral__card-title">Your Current Level</h2>
                        <div class="referral__card-wrap-fill-desc-wrap">
                            <p class="referral__card-wrap-fill-gold-title"><img src="img/icon/gold.svg" width="20"
                                    height="20" alt="" class="referral__card-wrap-fill-gold-icon"> Gold</p>
                            <p class="referral__card-wrap-fill-desc"><span class="sum">$ 43,755.71</span> to next level
                            </p>
                        </div>
                    </div>
                    <div class="referral__card-wrap">
                        <div class="referral__card-wrap-light">
                            $ 57,244.29
                        </div>
                        <div class="referral__card-wrap-dark">
                            $ 100,000
                        </div>
                    </div>
                </article>
                <article class="referral__card">
                    <h2 class="referral__card-title">Share Your Referral Link</h2>
                    <div class="referral__card-qr">
                        <img src="img/qr-code.webp" width="150" height="150" alt="QR-Code"
                            class="referral__card-qr-img">
                    </div>
                    <div class="referral__card-input-wrap">
                        <input type="text" class="referral__card-input"
                            value="https://docs.google.com/dory.f2421dfafw2f2421dfafw2f2421dfafw2f2421dfafw2f2421dfafw2f2421dfafw2">
                        <button type="button" class="referral__card-input-btn"><img src="img/icon/content_copy.svg"
                                width="20" height="20" alt="Copy" class="referral__card-input-icon"></button>
                    </div>
                    <div class="referral__card-download-wrap">
                        <div class="referral__card-download-field">
                            <h3 class="referral__card-download-title">Download SVG</h3>
                            <p class="referral__card-download-desc">Scalable vector graphic</p>
                        </div>
                        <button type="button" class="referral__card-download-btn"><img src="img/icon/download.svg"
                                width="20" height="20" alt="Download SVG"
                                class="referral__card-download-btn-icon"></button>
                    </div>
                </article>
            </div>
        </div>
        <div class="referral__wrap">
            <article class="referral__card">
                <h2 class="referral__card-title">Rating Table</h2>
                <div class="matrix">
                    <table class="matrix__table">
                        <thead>
                            <tr>
                                <th>
                                    <p class="matrix__title"><span>Lvl 1</span></p>
                                </th>
                                <th>
                                    <p class="matrix__title"><span>Line 1</span> <span>6%</span></p>
                                </th>
                                <th>
                                    <p class="matrix__title"><span>Line 2</span> <span>7%</span></p>
                                </th>
                                <th>
                                    <p class="matrix__title"><span>Line 3</span> <span>8%</span></p>
                                </th>
                                <th>
                                    <p class="matrix__title"><span>Line 4</span> <span>9%</span></p>
                                </th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                            </tr>
                        </thead>

                        <tbody>
                            <tr>
                                <th scope="row">
                                    <p class="matrix__title column">Lvl 2 <span class="sub">From $50k</span></p>
                                </th>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>

                            <tr>
                                <th scope="row">
                                    <p class="matrix__title column">Lvl 3 <span class="sub">From $150k</span></p>
                                </th>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>

                            <tr>
                                <th scope="row">
                                    <p class="matrix__title column">Lvl 4 <span class="sub">From $250k</span></p>
                                </th>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>

                            <tr>
                                <th scope="row">
                                    <p class="matrix__title column">Lvl 5 <span class="sub">From $350k</span></p>
                                </th>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>

                            <tr>
                                <th scope="row">
                                    <p class="matrix__title column">Lvl 6 <span class="sub">From $350k</span></p>
                                </th>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>

                            <tr>
                                <th scope="row">
                                    <p class="matrix__title column">Lvl 7 <span class="sub">From $350k</span></p>
                                </th>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>

                            <tr>
                                <th scope="row">
                                    <p class="matrix__title column">Lvl 8 <span class="sub">From $350k</span></p>
                                </th>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td></td>
                                <td></td>
                            </tr>

                            <tr>
                                <th scope="row">
                                    <p class="matrix__title column">Lvl 9 <span class="sub">From $350k</span></p>
                                </th>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td></td>
                            </tr>

                            <tr>
                                <th scope="row">
                                    <p class="matrix__title column">Lvl 10 <span class="sub">From $350k</span></p>
                                </th>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                                <td>
                                    <p class="matrix__desc">17%</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </article>
        </div>
    </section>

    <script>
        document.addEventListener("click", (e) => {
            const btn = e.target.closest(".referral__grid-card-user");
            const tooltipOpened = document.querySelector(".referral__grid-user-tooltip:not([hidden])");

            if (btn) {
                const card = btn.closest(".referral__grid-card");
                const tooltip = card.querySelector(".referral__grid-user-tooltip");

                if (tooltipOpened === tooltip) {
                    tooltip.hidden = true;
                    card.style.zIndex = "";
                    return;
                }

                document.querySelectorAll(".referral__grid-user-tooltip").forEach(t => t.hidden = true);
                document.querySelectorAll(".referral__grid-card").forEach(c => c.style.zIndex = "");

                tooltip.hidden = false;
                card.style.zIndex = 1000;
                return;
            }

            if (tooltipOpened && !e.target.closest(".referral__grid-user-tooltip")) {
                tooltipOpened.hidden = true;
                document.querySelectorAll(".referral__grid-card").forEach(c => c.style.zIndex = "");
            }
        });
    </script>

    <script>
        document.addEventListener("click", (e) => {
            const copyBtn = e.target.closest(".referral__card-input-btn");
            if (!copyBtn) return;

            const input = copyBtn.closest(".referral__card-input-wrap")?.querySelector(".referral__card-input");
            if (!input) return;

            navigator.clipboard.writeText(input.value)
                .then(() => {
                    copyBtn.classList.add("copied");
                    setTimeout(() => copyBtn.classList.remove("copied"), 800);
                })
                .catch(err => console.error("Copy failed:", err));
        });
    </script>

    <script>
        (() => {
            const cards = document.querySelectorAll('.referral__grid-card.active');
            if (!cards.length) return;

            for (const card of cards) {
                const status = card.querySelector('.referral__grid-status');
                if (!status) continue;

                const textNode = [...status.childNodes].find(n => n.nodeType === Node.TEXT_NODE);
                if (textNode) {
                    textNode.textContent = ' Active';
                }
            }
        })();
    </script>

    <script>
        (function () {
            const grid = document.querySelector('.referral__grid');
            if (!grid) return;

            // Берём только реальные узлы (с карточкой)
            const itemEls = [...grid.querySelectorAll('.referral__grid-item[data-id]')];

            if (!itemEls.length) return;

            // Строим структуру узлов
            const nodesById = new Map();

            itemEls.forEach(el => {
                const id = el.dataset.id;
                const parentId = el.dataset.parent || null;
                nodesById.set(id, {
                    id,
                    parentId,
                    el,
                    children: [],
                    col: null,
                    level: null,
                });
            });

            // Линковка детей к родителям
            nodesById.forEach(node => {
                if (!node.parentId) return;
                const parent = nodesById.get(node.parentId);
                if (parent) {
                    parent.children.push(node);
                }
            });

            // Находим корень (или первый без parent)
            const roots = [...nodesById.values()].filter(
                n => !n.parentId || !nodesById.has(n.parentId)
            );
            if (!roots.length) return;

            const root = roots[0];

            // Строим уровни (depth)
            const levels = [];
            levels.push([root]);

            let idx = 0;
            while (idx < levels.length) {
                const current = levels[idx];
                const next = [];
                current.forEach(node => {
                    node.level = idx;
                    node.children.forEach(ch => {
                        next.push(ch);
                    });
                });
                if (next.length) {
                    levels.push(next);
                }
                idx++;
            }

            // Считаем максимальное количество детей у любого родителя
            let maxChildren = 0;
            nodesById.forEach(node => {
                if (node.children.length > maxChildren) {
                    maxChildren = node.children.length;
                }
            });
            // минимум 3 колонки
            const maxCols = Math.max(3, maxChildren || 1);

            // === Распределение колонок ===
            // Root в центре
            root.col = Math.floor(maxCols / 2);

            // Для каждого уровня ниже root:
            for (let levelIndex = 1; levelIndex < levels.length; levelIndex++) {
                const levelNodes = levels[levelIndex];

                // Чтобы одного родителя не обрабатывать несколько раз
                const processedParents = new Set();

                levelNodes.forEach(node => {
                    const parent = nodesById.get(node.parentId);
                    if (!parent) return;

                    // Если уже расставили детей этого родителя — пропускаем
                    if (processedParents.has(parent.id)) return;
                    processedParents.add(parent.id);

                    const children = parent.children;
                    if (!children.length) return;

                    // Родитель должен уже иметь col
                    const baseCol = parent.col ?? Math.floor(maxCols / 2);

                    // Дети выстраиваются вокруг родителя "в ряд"
                    const k = children.length;
                    let startCol = baseCol - Math.floor((k - 1) / 2);

                    // Клампим чтобы не вывалиться за 0..maxCols-1
                    if (startCol < 0) startCol = 0;
                    if (startCol + k - 1 > maxCols - 1) {
                        startCol = maxCols - k;
                    }

                    children.forEach((child, i) => {
                        child.col = startCol + i;
                        child.level = parent.level + 1;
                    });
                });
            }

            // На всякий случай: если вдруг у кого-то не выставилась col — кидаем его в центр
            levels.forEach(level => {
                level.forEach(node => {
                    if (node.col == null) {
                        node.col = Math.floor(maxCols / 2);
                    }
                });
            });

            // === Перестраиваем grid полностью ===
            const newGrid = document.createElement('div');
            newGrid.className = 'referral__grid';

            // Идём по уровням сверху вниз
            levels.forEach(level => {
                // Создаём пустые ячейки уровня
                const rowCells = Array.from({ length: maxCols }, () => {
                    const cell = document.createElement('div');
                    cell.className = 'referral__grid-item';
                    return cell;
                });

                // Наполняем карточками по col
                level.forEach(node => {
                    const targetCell = rowCells[node.col];

                    // Переносим содержимое старой ячейки в новую
                    while (node.el.firstChild) {
                        targetCell.appendChild(node.el.firstChild);
                    }

                    // Переносим дата-атрибуты
                    targetCell.dataset.id = node.id;
                    if (node.parentId) {
                        targetCell.dataset.parent = node.parentId;
                    } else {
                        delete targetCell.dataset.parent;
                    }
                });

                // Добавляем все ячейки в новый grid
                rowCells.forEach(cell => newGrid.appendChild(cell));
            });

            // Заменяем старый grid новым
            grid.replaceWith(newGrid);

            // Обновляем gridTemplateColumns под maxCols
            newGrid.style.gridTemplateColumns = `repeat(${maxCols}, 1fr)`;
        })();
    </script>

    <script>
        (function drawReferralLines() {
            const linesCanvas = document.querySelector('.referral__grid-lines');
            const ctx = linesCanvas.getContext('2d');
            const gridCanvas = document.querySelector('.referral__grid-canvas');
            const grid = document.querySelector('.referral__grid');

            function getPan() {
                if (!window.__PAN_X) return { x: 0, y: 0 };
                return { x: window.__PAN_X(), y: window.__PAN_Y() };
            }

            function resizeCanvas() {
                linesCanvas.width = gridCanvas.clientWidth;
                linesCanvas.height = gridCanvas.clientHeight;
            }

            function getLocalRect(elem) {
                const pan = getPan();
                const r = elem.getBoundingClientRect();
                const g = grid.getBoundingClientRect();
                return {
                    left: r.left - g.left - pan.x,
                    top: r.top - g.top - pan.y,
                    width: r.width,
                    height: r.height
                };
            }

            function draw() {
                resizeCanvas();
                ctx.clearRect(0, 0, linesCanvas.width, linesCanvas.height);

                ctx.strokeStyle = "rgba(255,255,255,0.20)";
                ctx.lineWidth = 2;
                ctx.lineCap = "round";

                const items = [...grid.querySelectorAll('.referral__grid-item[data-id]')];
                const map = new Map();
                items.forEach(i => map.set(i.dataset.id, i));

                const parentChildren = new Map();
                items.forEach(child => {
                    const p = child.dataset.parent;
                    if (!p) return;
                    if (!parentChildren.has(p)) parentChildren.set(p, []);
                    parentChildren.get(p).push(child);
                });

                parentChildren.forEach((children, parentId) => {
                    const parentItem = map.get(parentId);
                    if (!parentItem) return;

                    const parentCard = parentItem.querySelector('.referral__grid-card');
                    if (!parentCard) return;

                    const pRect = getLocalRect(parentCard);
                    const parentX = pRect.left + pRect.width / 2;
                    const parentBottom = pRect.top + pRect.height;
                    const vOffset = 25;

                    if (children.length === 1) {
                        const cRect = getLocalRect(children[0].querySelector('.referral__grid-card'));
                        const childX = cRect.left + cRect.width / 2;
                        const childTop = cRect.top;

                        ctx.beginPath();
                        ctx.moveTo(parentX, parentBottom);
                        ctx.lineTo(parentX, parentBottom + vOffset);
                        ctx.lineTo(childX, parentBottom + vOffset);
                        ctx.lineTo(childX, childTop);
                        ctx.stroke();
                        return;
                    }

                    const coords = children.map(ch => {
                        const r = getLocalRect(ch.querySelector('.referral__grid-card'));
                        return {
                            x: r.left + r.width / 2,
                            top: r.top
                        };
                    });

                    const minX = Math.min(...coords.map(c => c.x));
                    const maxX = Math.max(...coords.map(c => c.x));
                    const midY = parentBottom + vOffset;

                    ctx.beginPath();
                    ctx.moveTo(parentX, parentBottom);
                    ctx.lineTo(parentX, midY);
                    ctx.stroke();

                    ctx.beginPath();
                    ctx.moveTo(minX, midY);
                    ctx.lineTo(maxX, midY);
                    ctx.stroke();

                    coords.forEach(c => {
                        ctx.beginPath();
                        ctx.moveTo(c.x, midY);
                        ctx.lineTo(c.x, c.top);
                        ctx.stroke();
                    });
                });
            }

            draw();

            window.addEventListener("resize", draw);
            wrap.addEventListener("wheel", draw);
            document.addEventListener("mousemove", draw);
            document.addEventListener("touchmove", draw);

        })();
    </script>

    <script>
        function initReferralPanorama(wrapSelector, canvasSelector, gridSelector) {
            const wrap = document.querySelector(wrapSelector);
            const canvas = document.querySelector(canvasSelector);
            const grid = document.querySelector(gridSelector);

            if (!wrap || !canvas || !grid) return;

            let isDown = false;
            let isTouch = false;
            let touchAxis = null; // "x" | "y"

            let offsetX = 0;
            let offsetY = 0;

            let dragStartMouseX = 0;
            let dragStartMouseY = 0;

            let dragStartOffsetX = 0;
            let dragStartOffsetY = 0;

            const clamp = (v, min, max) => Math.min(Math.max(v, min), max);

            function getBounds() {
                const wrapW = wrap.clientWidth;
                const wrapH = wrap.clientHeight;

                const contentW = grid.scrollWidth;
                const contentH = grid.scrollHeight;

                let minX, maxX, minY, maxY;

                // Horizontal
                if (contentW <= wrapW) {
                    const centerX = (wrapW - contentW) / 2;
                    minX = maxX = centerX;
                } else {
                    minX = wrapW - contentW;
                    maxX = 0;
                }

                // Vertical
                if (contentH <= wrapH) {
                    const centerY = (wrapH - contentH) / 2;
                    minY = maxY = centerY;
                } else {
                    minY = wrapH - contentH;
                    maxY = 0;
                }

                return { minX, maxX, minY, maxY };
            }

            function applyTransform() {
                const { minX, maxX, minY, maxY } = getBounds();

                offsetX = clamp(offsetX, minX, maxX);
                offsetY = clamp(offsetY, minY, maxY);

                canvas.style.transform = `translate(${offsetX}px, ${offsetY}px)`;
            }

            function center() {
                const wrapW = wrap.clientWidth;
                const contentW = grid.scrollWidth;

                offsetX = (wrapW - contentW) / 2;
                offsetY = 0;

                applyTransform();
            }

            // ----------------------------------------------------
            //   MOUSE DRAG (only horizontal)
            // ----------------------------------------------------
            wrap.addEventListener("mousedown", e => {
                isDown = true;
                isTouch = false;

                dragStartMouseX = e.pageX;
                dragStartOffsetX = offsetX;
            });

            document.addEventListener("mousemove", e => {
                if (!isDown || isTouch) return;

                const { minX, maxX } = getBounds();
                const dx = e.pageX - dragStartMouseX;

                offsetX = clamp(dragStartOffsetX + dx, minX, maxX);
                canvas.style.transform = `translate(${offsetX}px, ${offsetY}px)`;
            });

            document.addEventListener("mouseup", () => {
                isDown = false;
            });

            // ----------------------------------------------------
            //   TOUCH DRAG (axis locked)
            // ----------------------------------------------------
            wrap.addEventListener("touchstart", e => {
                isDown = true;
                isTouch = true;

                dragStartMouseX = e.touches[0].pageX;
                dragStartMouseY = e.touches[0].pageY;

                dragStartOffsetX = offsetX;
                dragStartOffsetY = offsetY;

                touchAxis = null;
            });

            wrap.addEventListener("touchmove", e => {
                if (!isDown || !isTouch) return;
                e.preventDefault();

                const t = e.touches[0];
                const dx = t.pageX - dragStartMouseX;
                const dy = t.pageY - dragStartMouseY;

                if (!touchAxis) {
                    touchAxis = Math.abs(dx) > Math.abs(dy) ? "x" : "y";
                }

                const { minX, maxX, minY, maxY } = getBounds();

                if (touchAxis === "x") {
                    offsetX = clamp(dragStartOffsetX + dx, minX, maxX);
                } else {
                    offsetY = clamp(dragStartOffsetY + dy, minY, maxY);
                }

                canvas.style.transform = `translate(${offsetX}px, ${offsetY}px)`;
            }, { passive: false });

            wrap.addEventListener("touchend", () => {
                isDown = false;
                isTouch = false;
                touchAxis = null;
            });

            // ----------------------------------------------------
            //   WHEEL (vertical only)
            // ----------------------------------------------------
            wrap.addEventListener("wheel", e => {
                offsetY -= e.deltaY;
                applyTransform();
                e.preventDefault();
            }, { passive: false });

            // INIT
            center();
            window.addEventListener("resize", center);
        }
    </script>

    <script>
        initReferralPanorama(
            ".referral__grid-wrap",
            ".referral__grid-canvas",
            ".referral__grid"
        );
    </script>
</body>

</html>